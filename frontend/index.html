<head>
    <script src="libs/seview-2.0.5-unpkg.js"></script>
    <script src="libs/mithril-2.2.2.js"></script>
    <script src="importEnv.js"></script>
    <script src="importSeviewMithril.js"></script>
    <script src="importRenderStream.js"></script>
    <script src="importExchange.js"></script>
</head>
<body>
    <ul id="messages">
    </ul>
    <input id="type_here" />
    <script>
        function logk(k, v) {
            console.log(k, v);
            return v;
        }
        const seviewMithril = importSeviewMithril(m);
        const h = seview.seview(seviewMithril);

        function buildUrl(protocol, host, port, path) {
            return `${protocol}://${host}:${port}/` + path.join('/');
        }
        const env = importEnv();
        const exchangeLib = importExchange({ window });
        const exchange = exchangeLib.init(
            buildUrl(env.WS_PROTOCOL, env.WS_HOST, env.WS_PORT, ['FAKE_SESSION_UUID']),
            {
                onOpen() {
                    exchange.joinChat('room1_UUID');
                },
            });

        const commonImportArgs = {
            exchange,
        };

        const messages = document.getElementById('messages');
        const renderStream = importRenderStream(commonImportArgs);
        renderStream(seDom => m.render(document.body, h(seDom)));
    </script>
</body>
